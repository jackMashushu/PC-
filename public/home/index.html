<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1500, initial-scale=1.0, maximum-scale=1.0">
    <title>千年文章网</title>
    <meta name="keywords" content="文章网,个人网站,千年文章,个人博客,原创文章,古诗集,古文,文言文,作文">
    <meta name="description" content="个人原创博客、文章，学习经验分享，优秀经典文章，唐诗宋词收集等">   
    <link rel="icon" href="./images/icon/w.png">
    <link rel="stylesheet" href="/home/css/style.css">
    <script>
    function isIE() { if (!!window.ActiveXObject || "ActiveXObject" in window)return true;else return false;}
    if(isIE()){alert('非常抱歉！本站没有针对ie浏览器兼容开发，因此无法正常显示。推荐使用Chrome、Firefox、Opera等高兼容性更好的浏览器！')}
    </script>
</head>
<body>
<div>
    <header >
        <div class="logo"><img class="logo-img" src="./images/logos/main-logo.gif" ></div>
        <ul class="title-nav">
            <li><a href="javascript:;">首页</a></li>
            <li id="aboutme"><a href="javascript:;">关于</a></li>
            <li><a href="/home/personal.html">个人中心</a></li>
            <li class="login-i"><img id="head" src="./images/icon/login.png" ><a id="login-door" target="_blank">登录</a></li>
        </ul>
    </header>
</div>
<div class="second-container">
     <div class="content-header">
        <div class="left-list">
          <div class="list-box">
              <h3>经典文学</h3>
              <a href="/home/special.html?famous">经典文章<img src="./images/icon/ink.png" ></a>
              <a href="/home/special.html?poem">诗歌词曲<img src="./images/icon/ink.png" ></a>
              <a href="/home/special.html?words">说文解字<img src="./images/icon/ink.png" ></a>
              <a href="/home/special.html?selected">名家精选<img src="./images/icon/ink.png" ></a>
          </div>
          <hr />
          <div class="list-box">
            <h3>优秀文章</h3>
            <a href="/home/special.html?junior">初中作文<img src="./images/icon/zuowen.png" ></a>
            <a href="/home/special.html?grade">小学作文<img src="./images/icon/zuowen.png" ></a>
            <a href="/home/special.html?fullMarks">满分作文<img src="./images/icon/zuowen.png" ></a>
            <a href="/home/special.html?saying">名言警句<img src="./images/icon/zuowen.png" ></a>
        </div>
        <hr />
        <div class="list-box">
            <h3>原创专区</h3>
            <a href="/home/special.html?prose">散文随记<img src="./images/icon/org.png" ></a>
            <a href="/home/special.html?history">历史故事<img src="./images/icon/org.png" ></a>
            <a href="/home/special.html?hot">热点分析<img src="./images/icon/org.png" ></a>
            <a href="/home/special.html?study">学习心得<img src="./images/icon/org.png" ></a>
        </div>             
        </div>
        <!-- 轮播 -->
        <div class="glide">
            <div class="banner" id="banner">
                <ul class="imgBox clearFix" >
                    <li ><img src="" ></li>
                    <li ><img src="" ></li>
                    <li ><img src="" ></li>
                </ul>
                <ol class="pointBox">
                </ol>
                <div class="leftright">
                    <span class="left">&lt;</span>
                    <span class="right">&gt;</span>
                </div>
            </div>
            <!-- 轮播 -->
           <div class="tools-box">
            <div class="tools-list">
                <span>实用工具：</span>
                <a href="" class="icon-btn">
                  <img src="./images/icon/tool-change.png" alt="">
                </a>
                <a href="" class="icon-btn">
                  <img src="./images/icon/tools-bagua.png" alt="">
                </a>
                <a href="" class="icon-btn icon-btn-set3">
                  <img src="./images/icon/upload.png" alt="">
                </a>
                <a href="" class="icon-btn icon-btn-set4">
                  <img src="./images/icon/star.png" alt="">
                </a>
                <a href="" class="icon-btn icon-btn-set5">
                  <img src="./images/icon/tool-book.png" alt="">
                </a>
                <a href="./column.html" class="icon-btn icon-btn-set6">
                  <img src="./images/icon/homesearch.png" alt="">
                </a>
                <a href="javascript:" class="icon-txt">获取更多......</a>
            </div>
           </div>
        </div>
        <div class="message">           
                <ul class="title-box">
                    <li class="active" >新推荐</li>
                    <li >新公告</li>           
                </ul>
                <ol class="mes-container">
                    <li class="active">
                        <ul class="show-article">
                   
                          
                        </ul>
                    </li>
                    <li >
                        <div class="news">
                          <div class="news-index">
                            <span id="news-index-1">1</span>
                            <span id="news-index-2">2</span>
                            <span id="news-index-3">3</span>
                            <span>4</span>
                            <span>5</span>
                            <span>6</span>
                            <span>7</span>
                          </div>
                          <div class="news-list">
                            
                          </div>                         
                        </div>
                    </li>            
                </ol>         
        </div>
   </div>
</div>
<div class="article-section">
  <div class="left-article-show">
    <div class="orignal">
        <div class="original-title">
           <h4>原创专区</h4><span>ORANGENAL</span>
           <a href="#">了解更多……</a>
        </div>

        <div class="left-content-flex">

        <div class="left-pic-box">
          <ul>
            
          </ul>
        </div> 

        <div class="left-article-list">
          <ul class="newslist">           
         </ul>
     </div>
     <div class="publish-banner">
         <div class="publish-picture-front">
             <img src="./images/show-pic/regict.gif" alt="" srcset="">
         </div>
         <div class="publish-picture-back">
           <span>请选择</span>
           <a href="#" class="regi">注 册</a>
           <a href="#" class="login">登 录</a>          
         </div>
    </div>


    </div>

  </div>


    <div class="hot-article">
        <div class="original-title">
          <h4>热点文章</h4><span>HOTART</span>
          <a href="#">了解更多……</a>
        </div> 
        <div class="article-long-show">
          <ul>          
          </ul>         
        </div> 
        <div class="pagination" id="pagi"></div>
    </div>

  </div>

<!-- 右侧区域大盒子 -->
 <div class="right-little-block" id="right-little-block">


    <div class="author-rank">

      <div class="original-title">
        <h4>机器人们</h4><span>RANK</span>
        <a href="#" class="sharing-more-btn"><img src="./images/icon/more.png" alt=""></a>
     </div>
        <div class="author-flex-box">
         <div class="order-num">
               <img src="./images/icon/no1.png" alt="">
               <img src="./images/icon/no2.png" alt="">
               <img src="./images/icon/no3.png" alt="">
               <span>4</span>
               <span>5</span>
               <span>6</span>
         </div>

         <div class="author-list">
            <ul>

            </ul>
         </div>

      </div>

    </div>

    <div class="gdthing-sharing">

            <div class="original-title">
              <h4>资源共享</h4><span>SHARE</span>
              <a href="#" class="sharing-more-btn"><img src="./images/icon/more.png" alt=""></a>
           </div>      
      
           <div class="share-flex-box">
            <div class="share-order-num">
                  <span>1</span>
                  <span>2</span>
                  <span>3</span>
                  <span>4</span>
                  <span>5</span>
                  <span>6</span>
                  <span>7</span>
                  <span>8</span>
                  <span>9</span>
            </div>

            <div class="share-list">
               <ul>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>

                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
                 <li><a href="">这里暂时还没有分享内容</a>
                  <img src="./images/icon/fire.png" alt="">
                 </li>
               </ul>
            </div>

   </div>

    </div>


</div>

</div>
<!-- 遮罩层 -->
<div class="shelter"></div>
<!-- 登录弹出层 -->
<div class="login-reg">
  <form class="login-box">
    <img src="/home/images/icon/close.png" class="img-close">
      <h3>普通用户登录</h3>
      <input type="email" name="username" id="log-username" placeholder="请输入账号……">
      <input type="password" name="username" id="log-password" placeholder="请输入密码……">
      <button type="button" class="login-btn" id="login-btn">登录</button>
      <span>现在还没有账号？</span>
      <button type="button" class="reg-button">立即注册</button>
      <a href="/admins/login">管理员登录点这里</a>
  </form>
</div>
<!-- 注册弹出层 -->
<div class="register-box">
  <form class="register-form">
    <img src="/home/images/icon/close.png" class="img-reg-close">
      <h3>普通用户注册</h3>
      <input type="text" name="email" id="reg-username" placeholder="请输入账号">
      <input type="password" name="password" id="reg-password" placeholder="请输入密码">
      <input type="password" name="password" id="reg-password2" placeholder="再次输入密码">
      <input type="text" name="username" id="reg-nickname" placeholder="请输入昵称">
      <input type="hidden" name="head"  id="head-reg" value="\uploads\head\upload_257ff1d32d02ebfe8c4bbb8065432779.jpg">
      <span class="warning-reg">&nbsp;</span>
      <button type="button" class="login-btn" id="reg-btn">注册</button>
      <span>已经有账号了？</span>
      <button type="button" class="reg-button">立即登录</button>
      <a href="/admins/login">管理员登录点这里</a>
  </form>
</div>
<!-- 关于弹出层 -->
<div class="aboutme">
  <img src="/home/images/icon/close.png" class="img-close-about">
  <div class="abt-web">
    <h4>「关于本站」</h4>
    <div class="abt-web-1">
    <span>性质</span><p>网站内容全部来自网站管理者整理或原创，普通用户无法在未经同意的情况下对本站展示区域的内容进行「发布、删除、修改」。
      本站属于文章分享、学习记录的个人博客网站，由个人独自开发完成，仅作学习交流所用，不作任何商业用途。若无意中侵犯了某些组织或个人的知识产权、肖像权、姓名权等，
      请务必来信告知，本站定立刻删除，妥善处理。
    </p>
    </div>

    <div class="abt-web-1">
      <span>结构</span>
          <div>
           <p>前端：HTML5、CSS3、javaScript、jQuery3.41、wangEditor-3.1.1(富文本编辑器)，template-web。</p>
           <p>后台：node.js、express框架、MongoDB 数据库、art-template。</p>
           <p>服务器、域名来自阿里云，系统：CentOS8。个人水平底下，大佬请勿嗤笑。</p>
          </div>
      </div>


  </div>
  <div class="abt-me">
    <h4>「关于我」</h4>
    <p>还没想好！</p>
  </div>
</div>


<!-- 页脚部分大盒子 -->
<div class="footer-container">
   
    <div class="footer-left">
       <span>友情链接</span>
       <div class="friendship">         
         <a href="" target="_blank">友情链接位置</a>

       </div>
    </div>

    <div class="footer-mid">
      <div><a href="">百度地图</a><a href="">文章归档</a><a href="">转载申请</a><a href="">友链申请</a></div>
       <div><a id="beian" style="font-weight: bold;" href="http://www.beian.miit.gov.cn/" target="_blank">陕ICP备20006976号</a><script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278902738'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1278902738%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script></div>
      <p>Copyright ©2020 wenhai Corporation, All Rights Reserved</p>
      <p>转载内容版权归原作者所有，本站原创样式及文章不作商用，使用请注明并联系：h779132341@qq.com</p>

    </div>

    <div class="footer-right">
      <section>
        <img src="./images/QRcode/weixin.jpg" > 
        <span>我的微信</span>
       </section>
      <section>
        <img src="./images/QRcode/alipay.gif" >
       <span>微信公众号</span>        
      </section>
    </div>
</div>

<script src="/home/js/jquery-3.4.1.min.js"></script>
<script src="/js/template-web.js"></script>
<script src="/home/js/index.js"></script> 
<script type="text/html" id="tpl">
  {{each result}}
  <li class="every-article-index">
    <img src="{{$value.cover}}" alt="">
    <div>
      <a href="/home/detail.html?id={{@$value._id}}" target="_blank" >{{$value.title}}</a>
      <p>摘要：{{@$value.describe.replace(/<[^>]+>/g,'').substr(0,180)+'...'}}</p>
      <span>{{$imports.dateFormat($value.publishDate)}}发布@{{$value.author.username}}/ 栏目·{{$value.class}} 评论0</span>
    </div>
  </li>
  {{/each}}
</script>
<script type="text/html" id="ranker">
  {{each ranker}}
  <li index="{{$value._id}}"><img class="head-sculpture" src="{{$value.head}}" alt=""><a href="javascript:;">{{$value.username}}</a><span>{{$value.count}}篇</span></li>
  {{/each}}
</script>
<script type="text/html" id="top-show">
  {{each top}}
  <li class="li-list">
    <div class="article-card" id="defaul-card-show"> 
        <img src="{{$value.cover}}" index="{{$value._id}}" srcset="">
        <div class="card-detail">    
            <a href="/home/detail.html?id={{$value._id}}">{{$value.title.substr(0,6)+'..'}}</a>
            <a href="/home/other.html?id={{$value.author._id}}">{{$value.author.username}}</a>
         </div>
     </div>
     <div class="article-show-sim" id="defaul-sim-show">
         <span>{{num++}}</span>
         <a href="#">{{$value.title.substr(0,7)+'..'}}</a>
         <p class="show-list-date">{{$imports.dateMonth($value.publishDate)}}</p>
     </div>              
 </li>
  {{/each}}
</script>
<script type="text/html" id="notice-show">
  {{each notice}}
  <a href="/home/detail.html?id={{$value._id}}">{{$value.title.substr(0,11)+'…'}}</a>
  {{/each}}
</script>
<script type="text/html" id="model-atc">
  {{each model}}
  <li>
    <a href="/home/detail.html?id={{$value._id}}"  class="left-pic-a" target="_blank">
      <img src="{{$value.cover}}">
      <div class="backdrop"></div>
      <span>{{$value.title}}</span>
    </a>
  </li>
  {{/each}}
</script>
<script type="text/html" id="left-article">
  {{each original}}
  <li class="{{ num==1?'article-first-model':''}}"> 
    <div class="condom">    
         <a href="/home/detail.html?id={{$value._id}}" title="{{$value.title}}" target="_blank"><i>{{num++}}</i>{{$value.title.substr(0,19)+'…'}}</a>
    </div>    
    <p>{{$value.describe.replace(/<[^>]+>/g,'').substr(0,100)+'...'}}</p>
 </li>
  {{/each}}
</script>
<script> 


const pageHeight=$(document).height();
const pageWidth=$(document).width();

// 登录盒子及遮罩层
$('#login-door').click(function(){
$('.shelter').css({
  height:pageHeight,
  width:pageWidth,
  display:'block'
});
$('.login-reg').toggleClass('active');
});

$('.img-close').click(function(){
  $('.login-reg').toggleClass('active');
  $('.shelter').css('display','none');
});
$('.login-btn').click(function(){
  $(this).toggleClass('active');
});
// 注册相关组件
$('.reg-button').click(function(){
  $('.login-reg').toggleClass('active');
  $('.register-box').toggleClass('active')
});
$('.img-reg-close').click(function(){
  $('.shelter').css('display','none');
  $('.register-box').toggleClass('active');

});
$('.regi').click(function(){
  $('.register-box').toggleClass('active');
  $('.shelter').css({
  height:pageHeight,
  width:pageWidth,
  display:'block'
});
  return false;
});
$('.login').click(function(){
  $('.shelter').css({
  height:pageHeight,
  width:pageWidth,
  display:'block'
  });
  $('.login-reg').toggleClass('active');
  return false;
})


// 时间格式化
template.defaults.imports.dateFormat=dateFormat;
function dateFormat(data){
    if(data){
        return data.split('T')[0];
    }else{
        return '没有时间';
    }  
}
template.defaults.imports.dateMonth=dateMonth;
function dateMonth(data){
    if(data){
       const pra= data.split('T')[0];
        return pra.split('2020-')[1];
    }else{
        return '';
    }  
}

// 模板渲染
$.ajax({
  url:'/home/index',
  type:'get',
  success:function(res){

       const pageIndex=new Pagination('#'+'pagi',{
       pagesize:7,
       total:res.total,
       pageChange:function(num){
            $.ajax({
              url:'/home/index',
              type:'get',
              data:{page:num},
              success:function(res2){
                //当作者被删除，这里需要重新设定默认作者，防止渲染失败
                $.each(res2.result,function(index,items){
                if(items.author==null){
                items.author={},
                items.author.username="丢失"
               }
              });
                var html=template('tpl',{result:res2.result});
                var ulBox=$('.article-long-show ul')[0];
                ulBox.innerHTML=html;
              }
            })
        }
       });
       pageIndex.init();
      $.each(res.result,function(index,items){
          if(items.author==null){
            items.author={},
            items.author.username="丢失"
          }
      });
     var html=template('tpl',{result:res.result});
     var ulBox=$('.article-long-show ul')[0];
     ulBox.innerHTML=html;
     
  }
});

//公告推荐栏请求
$.ajax({
  url:'/home/notice',
  success:function(res){
    const html1=template('top-show',{top:res.showatc,num:1});
    const html2=template('notice-show',{notice:res.noticeatc});
    $('.show-article')[0].innerHTML=html1;
    $('.news-list')[0].innerHTML=html2;
    //外面获取不到，需要在这里显示隐藏
    $('#defaul-card-show').css('display','flex');
    $('#defaul-sim-show').css('display','none');
  }
});
// 原创专区请求
$.ajax({
  url:'/home/original',
  success:function(res){
    const html1=template('model-atc',{model:res.modelatc});
    const html2=template('left-article',{original:res.originalatc,num:1});
    $('.left-pic-box>ul')[0].innerHTML=html1;
    $('.newslist')[0].innerHTML=html2;
      $('.article-first-model').css({
      border: '1px solid rgb(247, 247, 247)',
      backgroundColor: 'rgb(247, 247, 247)',
      height:' 100px'
    });

  }
});
//轮播图友链请求
$.ajax({
  url:'/home/slide',
  success:function(res){
    let slideStr='';
    let friendStr='';
    $.each(res.slideall,function(index,items){
       slideStr+=`<li ><img src="${items.path}" ></li>`
    });
    $('.imgBox')[0].innerHTML=slideStr;
    $.each(res.friends,function(index,items){
       friendStr+=`<a href="${items.path}" target="_blank">${items.keywords}</a>`
    });
    $('.friendship')[0].innerHTML=friendStr;
    // 启动器：
    const p1=new Banner("#banner"); 
  }
})

// 登录请求
$('#login-btn').click(function(){
  const username=$('#log-username').val();
  const password=$('#log-password').val();
  $.ajax({
  url:'/admins/login',
  type:'post',
  data:{email:username,password:password},
  success:function(res){
      if(res=='fail'){
        $('#login-btn').text('账号或密码错误！');
      }
      $('#login-btn').blur(function(){$(this).text('登录')});
      if(res.flag==true){
        for(let attr in res.cookies){
            // 管理员跳转后台并储存cookie
            var str=`${attr}=${res.cookies[attr]}`;
            document.cookie=str;
            window.location.href='/admins/userEdit';
            }       
        }
        if(res.flag==false){
          for(let attr in res.cookies){
                var str=`${attr}=${res.cookies[attr]}`;
                document.cookie=str
            }
            window.location.href='/home/personal.html'; 
        }
}});
});

// 注册请求
$('#reg-btn').click(function(){
  const email=$('#reg-username').val();
  let password=$('#reg-password').val();
  let password2=$('#reg-password2').val();
  const username=$('#reg-nickname').val();
  const head=$('#head-reg').val();
  if(password==password2){
    $.ajax({
      url:'/home/register',
      type:'post',
      data:{email:email,password:password,username:username,head:head},
      success:function(res){
          if(res=='bingo'){
            $('.warning-reg').text("注册成功，现在您可以点击进行登录啦！").css('color','green')

          }else{
          $('.warning-reg').text(res)
          }
      }
    })
  }else{
    $('.warning-reg').text('两次密码不一致！')
  }
})


// 调用cookie
window.addEventListener('load',function(){
  if(getCookie('username')){
    let headPic=getCookie('head');
    $('#head').attr('src',headPic);
    $('#login-door').text('换号')
  }
})

//网站编辑模块
window.addEventListener('load',function(){
  $.ajax({
    url:'/home/rank',
    type:'get',
    success:function(res){
        const html=template('ranker',{ranker:res});
        $('.author-list ul')[0].innerHTML=html
    }
  })
});
$('.author-list ul').on('click','li',function(){
const quer=$(this).attr('index');
window.open('/home/other.html?id='+quer,'_blank')
});
//关于我
$('#aboutme').click(function(){
  $('.aboutme').css('transform','translateY(0vw)');
});
$('.img-close-about').click(function(){
  $('.aboutme').css('transform','translateY(-90vw)');
})
</script>
</body>
</html>